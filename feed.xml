<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.3.2">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2024-04-21T21:20:53+08:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">Leighton’s Blog</title><subtitle>Learning &amp; Sharing
</subtitle><author><name>Leighton Wang</name><email>wtrwang7@sjtu.edu.cn</email></author><entry><title type="html">Raspberry Pi 的重装（有网线，无显示屏）</title><link href="http://localhost:4000/misc/raspberryPi/" rel="alternate" type="text/html" title="Raspberry Pi 的重装（有网线，无显示屏）" /><published>2024-04-21T00:00:00+08:00</published><updated>2024-04-21T00:00:00+08:00</updated><id>http://localhost:4000/misc/raspberryPi</id><content type="html" xml:base="http://localhost:4000/misc/raspberryPi/"><![CDATA[<p>毕设开始做实验了！</p>

<p>两周前从老师那拿到一块 Raspberry Pi，今天准备在上边跑一组实验。然而这块板子早已成为别人的形状，用户名和密码都无从得知，遂重装系统。过程中遇到很多奇怪的问题，在此作记录。</p>

<hr />

<h1 id="我的设备">我的设备</h1>
<p>我有以下设备：</p>
<ul>
  <li>Raspberry 4B 一块（老师给的，通过对比图片得知型号）</li>
  <li>网线一根（也是老师给的）</li>
  <li>USB-C 充电器一个（还是老师给的，用着没问题，似乎建议使用原装）</li>
  <li>SD 卡读卡器一个（学校数码店购入）</li>
</ul>

<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/misc/raspberrypi.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">我的 Raspberry Pi</div>
</center>
<p><br /></p>

<hr />

<h1 id="软件与系统准备">软件与系统准备</h1>
<p>以下操作在自己的 PC 上完成。</p>

<p>在 Raspberry Pi 官方网站上下载<a href="https://www.raspberrypi.com/software/">烧录工具</a> (Raspberry Pi Imager)，如下图</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/misc/Imager.png" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">Raspberry Pi Imager</div>
</center>
<p><br /></p>

<p>再在<a href="https://www.raspberrypi.com/software/operating-systems/">这里</a>下载系统。我选择的是最上方的 Raspberry Pi OS with desktop。</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/misc/piOS.png" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">Raspberry Pi Imager</div>
</center>
<p><br /></p>

<hr />

<h1 id="烧录-sd-卡">烧录 SD 卡</h1>
<h2 id="格式化-sd-卡">格式化 SD 卡</h2>
<p>首先需要格式化 SD 卡。网上很多教程说需要用什么第三方工具之类，经实测并不需要，直接在“此电脑”处右击 SD 卡对应的磁盘并选择格式化即可，文件系统选择 FAT32。</p>

<h2 id="开始烧录">开始烧录</h2>
<p>启动 Raspberry Pi Imager，如下图。</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/misc/imagerSettings.png" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">Raspberry Pi Imager</div>
</center>
<p><br />
Raspberry Pi 选择自己的型号（我的是 4），需要写入的操作系统选择 cutsom，然后选择先前下载的 .img.xz 格式的文件，存储卡选择自己的 SD 卡即可。</p>

<p>选择完成后点击 NEXT 开始烧录。可自定义用户名和密码，并开启 ssh 服务。等待烧录完成即可。</p>

<hr />

<h1 id="使用-ssh-连接到电脑">使用 ssh 连接到电脑</h1>
<p>按照<a href="https://blog.csdn.net/wallace89/article/details/120473842">这篇博客</a>的教程设置网络共享，并将树莓派连接到电脑。然而尝试使用 ssh 连接时直接超时。使用读卡器查看 SD 卡内容，新建 ssh 文件（空文件，无后缀），再次尝试连接成功（原因未知），如图所示。</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/misc/pi_cmd.png" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">PuTTY 通过 ssh 连接成功</div>
</center>
<p><br /></p>

<p>ping 通外部网站，说明网络共享成功！</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/misc/pi_ping.png" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">PuTTY 通过 ssh 连接成功</div>
</center>
<p><br /></p>

<p>此后计划在这块 Raspberry Pi 上进行试验。</p>]]></content><author><name>Leighton</name></author><category term="MISC" /><summary type="html"><![CDATA[毕设开始做实验了！]]></summary></entry><entry><title type="html">日本之行 关东篇</title><link href="http://localhost:4000/%E8%A1%8C%E4%B8%96%E8%B7%AF/trip-to-japan-kantou/" rel="alternate" type="text/html" title="日本之行 关东篇" /><published>2024-04-08T00:00:00+08:00</published><updated>2024-04-08T00:00:00+08:00</updated><id>http://localhost:4000/%E8%A1%8C%E4%B8%96%E8%B7%AF/trip-to-japan-kantou</id><content type="html" xml:base="http://localhost:4000/%E8%A1%8C%E4%B8%96%E8%B7%AF/trip-to-japan-kantou/"><![CDATA[<p>自寒假写了关西的游记后，由于懒癌晚期一直没有把关东篇也写掉。在这毕设中期答辩憋不出几个字的今天，把这个坑先给挖开。</p>

<hr />

<h1 id="1-月-18-日富士河口湖">1 月 18 日：富士河口湖</h1>

<h2 id="交通京都--富士河口湖">交通：京都 → 富士河口湖</h2>
<p>这天从京都前往富士河口湖（かわぐちこ）。谷歌地图说最快的方法是新干线坐到东京，前往新宿转乘富士急巴士，但是鉴于计划下一天才去东京，感觉有点怪异，故决定乘坐新干线到静冈县的三島（みしま），在那里乘坐富士急巴士前往东京。</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/kyoto2kawaguchiko.png" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">路线</div>
</center>
<p><br /></p>

<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/kyoto_shinkansen.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">京都站新干线站台，我们乘坐的是 10:08 的光（ひかり）号</div>
</center>
<p><br /></p>

<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/mishima.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">三岛市远眺富士山</div>
</center>

<p><br /></p>

<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/mishima_nihonU.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">三岛市 日本大学 (Nihon University) 三岛校区</div>
</center>

<h2 id="河口湖风光">河口湖风光</h2>
<p>于中午某个时刻抵达河口湖。在三岛站买巴士票的时候太着急（发车前两分钟），把售票窗口压票的小物件不小心顺走了 :( 于是到站后拜托運転士さん帮忙送回去了。事实证明标日上前15课加一些肢体语言和一些英语还是可以交流的 XD</p>

<p>这天天气很棒，真的很幸运！</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/lawson.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">河口湖站西边的经典打卡地 罗森</div>
</center>
<p><br /></p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/kawaguchiko_house.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">民宿和窗中的富士山</div>
</center>
<p><br /></p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/kawa_eki.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">傍晚的河口湖站</div>
</center>
<p><br />
和大伙闲逛，遇到了一列从站东侧道口（踏切）驶入的列车</p>
<div class="video-container" style="
    position: relative;
    padding-bottom:56.25%;
    padding-top:30px;
    height:0;
    overflow:hidden;
">
<iframe src="/assets/images/JapanTrip/train.mp4" width="560" height="315" frameborder="0" allowfullscreen="" style="
    position: absolute;
    top:0;
    left:0;
    width:100%;
    height:100%;
">
</iframe>
</div>

<hr />

<h1 id="1-月-19-日东京镰仓">1 月 19 日：东京、镰仓</h1>
<p>这天前往东京。从河口湖站乘坐富士急巴士到达新宿 Busta （就是宇宙中心新宿站的对面）</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/bus2tokyo.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">在首都高上望向新宿（堵车了）</div>
</center>
<p><br /></p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/shinjuku.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">新宿站（新宿 Busta 一侧摄）</div>
</center>

<h2 id="镰仓--江ノ電">镰仓 &amp; 江ノ電</h2>
<p>Gucci 同学对麻衣学姐爱得热烈，无论如何想去一趟镰仓。于是没找到空行李柜的众人拖着箱子乘坐小田急电前往神奈川县藤泽、镰仓。</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/kamakura_koukoumae.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">镰仓高校前（侧边摄）</div>
</center>
<p><br /></p>

<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/kamakura.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">坐在海边小喝一杯 @<a href="https://maps.app.goo.gl/jtYX6SA4kUY1cLnh7">トライアングル七里ガ浜</a></div>
</center>
<p><br /></p>

<h2 id="栖东京都墨田区">栖：东京都墨田区</h2>
<p>东京时间下午五点左右，从藤泽前往在东京的住处墨田区 京成曳舟（けいせいひきふね）站附近。乘坐小田急線（藤沢→新宿）、都営地下鉄新宿線（新宿→馬喰横山）、都営地下鉄浅草線（直通京成押上線，東日本橋→京成曳舟）</p>

<p>为什么要绕去新宿？当然是因为买了小田急和江之电的一日通票TAT</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/shimokitazawa.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">下　北　沢</div>
</center>
<p><br />
住处离东京晴空塔不远。</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/skytree.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">Tokyo Skytree</div>
</center>
<p><br /></p>

<p>民宿房东的地址信息写的不太对，我们照着门牌号敲开了本地一位老奶奶的门。一顿艰难的沟通后老奶奶突然明白了我们应该是附近那家民宿的住客，给我们指了民宿方向，感谢她，感谢《标准日本语》XP</p>

<hr />

<h1 id="1-月-20-日东京漫游">1 月 20 日：东京漫游</h1>
<p>一觉起来，Gucci 和 Woozie 都睡昏过去了，没有醒来的意思，于是决定分头行动。在二楼餐桌上给他们留下 15000 円后，与 Sam 和 Ms.Pu 开始了今天的行程。</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/money4gucci.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">父爱如山（bushi）</div>
</center>
<p><br /></p>

<h2 id="浅草寺">浅草寺</h2>
<p>这次乘坐东武晴空塔线从曳舟前往浅草。</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/Tobu.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">曳舟4号站台（原友真是无处不在）</div>
</center>
<p><br /></p>

<p>在浅草寺门口吃了寿司</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/sushiEi.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">午饭 @<a href="https://maps.app.goo.gl/zQ56LmAVDcQoMieJ9">すし栄</a></div>
</center>
<p><br /></p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/sensoji.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">浅草寺</div>
</center>
<p><br /></p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/senso_omikuji.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">好晦气的御神签</div>
</center>
<p><br /></p>

<h2 id="东京塔涩谷">东京塔、涩谷</h2>
<p>到了东京多少要来东京塔打个卡对吧（真的只是打了个卡）
都营浅草线 浅草→大門</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/tokyotower.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">摄于芝大神宫</div>
</center>
<p><br /></p>

<p>此后乘坐都营大江户线（赤羽橋→青山一丁目）和半藏门线（青山一丁目→渋谷）到达涩谷。可惜去的时候还不太了解<del>牢师</del>咒回，不然一定要去和宿傩碰一碰（</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/shibuya109.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">涩谷109大厦（被体育生扔过的牌子）</div>
</center>
<p><br /></p>

<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/JRShibuya.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">涩谷十字路口和一列品川、东京方面的山手线</div>
</center>
<p><br /></p>

<p>此后在唐吉诃德买买买，在<a href="https://maps.app.goo.gl/wZ43KypU8d1uacd17">焼肉ライク</a>大吃了一顿烤肉（太好吃了以至于没怎么拍照，墙裂推荐）</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/ShibuyaNight.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">夜晚（拍照技术太差太差）</div>
</center>
<p><br /></p>

<hr />

<h1 id="1-月-21-日东京漫游">1 月 21 日：东京漫游</h1>
<p>今天依然是分头行动的一天。</p>

<h2 id="秋叶原">秋叶原</h2>
<p>二刺螈当然要来秋叶原啦！</p>

<p>乘坐京成押上线（直通都营浅草线，京成曳舟→浅草橋）和 JR 中央-总武线各站停车（浅草橋→秋葉原）到达秋叶原。在<a href="https://maps.app.goo.gl/n4mZFMxyYCMaGyBy9">CoCo一番屋</a>来了一顿咖喱猪排。</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/ichibanya.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">咖喱猪排饭加炸鸡块（约 75 RMB）</div>
</center>
<p><br /></p>

<p>小逛了一下，在<a href="https://maps.app.goo.gl/MrCzF4LYXbzGJC9r8">秋叶原Animate</a>买了一些周边。拍的照并不多。</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/akihabara.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">秋叶原</div>
</center>
<p><br /></p>

<p>逛完后资深二次元 Ms.Pu 想前往池袋继续逛，于是三人小组继续分头行动。我和 Sam 到附近的御茶ノ水打了卡，在<a href="https://maps.app.goo.gl/DNybaBuJJcQhBGQz7">星乃咖啡店</a>歇息了一会。</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/ochanomizu.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">御茶之水“圣桥”和刚从地下驶出的<del>蚓厄</del>丸之内线</div>
</center>
<p><br /></p>

<h2 id="须贺神社">须贺神社</h2>
<p>此后民工水平二次元的二人前往《你的名字》圣地之一的<a href="https://maps.app.goo.gl/gk7vh34gSU7qUVtx9">须贺神社</a>打卡</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/sugaStairs.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">那把楼梯（天气不好，只能来点滤镜救一下了）</div>
</center>
<p><br /></p>

<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/suga2.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">擦肩而过之时</div>
</center>
<p><br /></p>

<h2 id="东大的门口">东大（的门口）</h2>
<p>其实下午还尝试去了东京大学，只是都比较怂，被门口「関係者以外立入禁止」的牌子唬住了，遂作罢。不过从南北线东大前车站出来的时候，东京的天空一改两日的阴沉，也让人心情愉悦不少。</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/akamon.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">东大赤门</div>
</center>
<p><br /></p>

<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/ochanomizu2.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">到御茶之水找丢失的伞，得到一张映在玻璃幕墙里的天空</div>
</center>
<p><br /></p>

<h2 id="银座">银座</h2>
<p>第一次知道银座应该是在东野圭吾的小说里，大概是《嫌疑人X的献身》？这次可以来到这里，亲眼看看老一辈资本主义国家的从容与自信（</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/ginza.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">银座的蓝调时刻</div>
</center>
<p><br /></p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/ginza2.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;"></div>
</center>
<p><br /></p>

<hr />

<h1 id="1-月-22-日回程">1 月 22 日：回程</h1>
<p>我们的日本之行在这天就告一段落了。人生第一次和出国旅行，与好朋友们一起探索、享受这广阔的世界 (=w=)</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="/assets/images/JapanTrip/aoto.jpg" />
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">从青砥回望东京，下次再见啦</div>
</center>
<p><br /></p>]]></content><author><name>Leighton</name></author><category term="行世路" /><summary type="html"><![CDATA[自寒假写了关西的游记后，由于懒癌晚期一直没有把关东篇也写掉。在这毕设中期答辩憋不出几个字的今天，把这个坑先给挖开。]]></summary></entry><entry><title type="html">AirSim：人工势场法避障</title><link href="http://localhost:4000/airsim/APF-test/" rel="alternate" type="text/html" title="AirSim：人工势场法避障" /><published>2024-03-02T00:00:00+08:00</published><updated>2024-03-02T00:00:00+08:00</updated><id>http://localhost:4000/airsim/APF-test</id><content type="html" xml:base="http://localhost:4000/airsim/APF-test/"><![CDATA[<p>参考一些已有的工作，在 AirSim 中实现了基于人工势场法（Artificial Potential Field, APF）和 LQR 控制的无人机避障任务仿真。</p>

<hr />

<h1 id="势函数与势场">势函数与势场</h1>
<h2 id="势函数">势函数</h2>
<p>常见的斥力势函数为
<span class="kdmath">$U_{\rm rep}(P)=\begin{cases}
\dfrac 12 \eta(\dfrac{1}{d(P,P_{\rm ob})}-\dfrac 1Q)^2, & d(P,P_{\rm ob})\leq Q \\
0,& d(P,P_{\rm ob})> Q
\end{cases}$</span></p>

<p>常见的引力势函数为
<span class="kdmath">$U_{\rm att}(P)=\dfrac 12\xi d^2(P,P_{\rm goal})$</span></p>

<p>$P$ 为无人机当前坐标，$P_{\rm ob}$ 为被计算势函数的障碍物的坐标，$Q$ 为障碍物的作用范围，$P_{\rm goal}$ 为目标点的坐标。</p>

<h2 id="计算方法">计算方法</h2>
<p>计算的方法为对势能计算负梯度得到下降方向，以该方向作为加速度的方向，通过加速度-速度-位置的方法实现控制。具体的计算方法：</p>

<div class="kdmath">$$
F_{\rm att}=-\nabla U_{\rm att}(P)=-\xi (P,P_{\rm goal})
$$</div>

<div class="kdmath">$$
F_{\rm rep}^i=-\nabla U_{\rm rep}(P)=\begin{cases}
\eta(\dfrac{1}{d(P,P_{\rm ob})} - \dfrac 1Q)\cdot\dfrac{1}{d^3(P,P_{\rm ob})} \cdot(P-P_{\rm ob}), & d(P,P_{\rm ob})\leq Q \\
0,& d(P,P_{\rm ob})> Q
\end{cases}
$$</div>

<div class="kdmath">$$
F_{\rm rep}=\sum_i F_{\rm rep}^i
$$</div>

<hr />

<h1 id="程序编写">程序编写</h1>
<p>使用 AirSim 的 Python API 编写仿真程序。程序逻辑如下：</p>

<ul>
  <li>在从当前航路点 $W_a$ 前往目标航路点 $W_b$ 的过程中：
    <ul>
      <li>计算矩阵 $A=\dfrac{1}{\Vert W_a-W_b \Vert^2}\left[I_2-(W_a-W_b)(W_a-W_b)^\top\right]$，其中 $I_2$ 是 2 阶单位矩阵。</li>
      <li>在每个控制周期 ${\rm d}t$ 内，进行航路点跟踪
        <ul>
          <li>计算：
            <ul>
              <li>$P_t=P-W_b$，$P$ 为无人机当前位置</li>
            </ul>
          </li>
          <li>若未检测到障碍物，则执行航路点跟踪
            <ul>
              <li>$U_1=K_0P_t+K_1AP_t$，其中 $K_0,K_1\in\mathbb{R}$ 是系数</li>
              <li>对 $U_1$ 进行限幅：若 $\vert U_1\vert &gt; U_{tmax}$，则 $U_1\leftarrow U_{tmax}\frac{U_1}{\vert U_1\vert}$</li>
            </ul>
          </li>
          <li>若检测到障碍物，则进行避障
            <ul>
              <li>$U_1=F_{att}+F_{rep}$</li>
              <li>对 $U_1$ 进行限幅：若 $\vert U_1\vert &gt; U_{amax}$，则 $U_1\leftarrow U_{amax}\frac{U_1}{\vert U_1\vert}$</li>
            </ul>
          </li>
          <li>$U=\frac{1}{K_2}(U_1-V)$</li>
        </ul>
      </li>
      <li>使用 LQR 执行计算得到的期望加速度
        <ul>
          <li>计算期望速度 $V_{next}=V+U\cdot {\rm d}t$</li>
          <li>计算期望位置 $P_{next}=U+V_{next}\cdot {\rm d}t$</li>
          <li>调用 LQR 控制函数，设置期望的位置和速度分别为 $V_{next}, P_{next}$</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<hr />

<h1 id="避障效果测试">避障效果测试</h1>
<p>使用 AirSim 自带的 Blocks 环境，通过调整起始位置、设置航路点，进行一个简单的避障仿真测试。飞控模式为 simple_flight。无人机的路径如下图：
<img src="/assets/images/airsim/APF_test.png" alt="APF_test" /></p>

<p>此图为俯视图，无人机从图片下方飞向上方。飞行过程中未发生碰撞（图片左上方显示 Collision Count: 0）。</p>

<hr />

<h1 id="高速飞行测试">高速飞行测试</h1>
<p>结合毕设的目标（评估飞行平台的计算性能），考虑如何体现计算对该任务的影响。</p>

<p>计算性能会直接影响到计算处理时间。不难想到，若在附近无障碍状态下的飞行速度变快，通过摄像头检测障碍物可用的时间便会变短；若计算时间不足，则无人机可能无法及时检测出障碍物、无法及时作出避障动作。</p>

<p>在上一节中，我们的使用的 $U_{tmax}=3$。我们通过改变无障碍时的速度限幅参数 $U_{tmax}$ 来改变最大幅度限制。当调整 $U_{tmax}=6$ 时，无人机会在飞行过程中与障碍物发生剐蹭。（做这两个视频的时候似乎在用耳机听歌，有一些奇怪的 BGM）</p>

<div class="video-container" style="
    position: relative;
    padding-bottom:56.25%;
    padding-top:30px;
    height:0;
    overflow:hidden;
">
<iframe src="/assets/images/airsim/U6.mp4" width="560" height="315" frameborder="0" allowfullscreen="" style="
    position: absolute;
    top:0;
    left:0;
    width:100%;
    height:100%;
">
</iframe>
</div>
<p><br /></p>

<p>而当 $U_{tmax}=7$ 时，无人机会径直撞上障碍物。</p>
<div class="video-container" style="
    position: relative;
    padding-bottom:56.25%;
    padding-top:30px;
    height:0;
    overflow:hidden;
">
<iframe src="/assets/images/airsim/U7.mp4" width="560" height="315" frameborder="0" allowfullscreen="" style="
    position: absolute;
    top:0;
    left:0;
    width:100%;
    height:100%;
">
</iframe>
</div>

<p><br /></p>

<p>在设想中，算力的提升应该可以允许无人机以更大的速度上限进行无碰撞飞行。在以上实例中，控制周期为 ${\rm d}t=\frac 1f=0.3s$；考虑到算力提升可以支持更高的控制周期，故我尝试调整 ${\rm}t=0.1s$。调整后，无人机确实可以做到以 $U_{amax}=7$ 的条件下无碰撞飞行。然而我在打开 Xbox 录屏程序尝试记录下该过程时，无人机却在飞行过程中发生了碰撞。这说明电脑 CPU 占用导致的算力降低导致了飞行质量的降低，进一步佐证了设想的正确性。在我把 ${\rm d}t$ 调整至 $0.07s$ 后，无人机可在录屏程序开启的前提下实现无障碍飞行了：</p>
<div class="video-container" style="
    position: relative;
    padding-bottom:56.25%;
    padding-top:30px;
    height:0;
    overflow:hidden;
">
<iframe src="/assets/images/airsim/U7dt007.mp4" width="560" height="315" frameborder="0" allowfullscreen="" style="
    position: absolute;
    top:0;
    left:0;
    width:100%;
    height:100%;
">
</iframe>
</div>

<p><br /></p>

<p>接下来，我们尝试将计算程序迁移到其他设备（如 WSL2、树莓派等）上进行硬(软)件在环仿真。</p>

<hr />

<h1 id="三维-apf-避障">三维 APF 避障</h1>
<p>原有的代码基于 LQR + 姿态角控制实现了无人机在水平方向上的避障任务。我采用了<a href="https://zhuanlan.zhihu.com/p/485796378">几何控制</a>的方法实现了在三维空间中的 APF 避障。</p>

<h2 id="几何控制">几何控制</h2>
<p>输入为期望的无人机位置、姿态、机体角速率 $x_d,R_d,\Omega_d$，输出为无人机的力与力矩 $f,M$。可由  $f, M$ 映射得到四旋翼各个电机的输入 $\sigma_1,\sigma_2,\sigma_3,\sigma_4$，进而通过 AirSim 的电机控制接口<code class="language-plaintext highlighter-rouge">client.moveByMotorPWMsAsync</code>进行控制。</p>

<h2 id="避障算法">避障算法</h2>
<p>将原有的 Carrot Chasing 轨迹跟踪及 APF 避障进行了到 3 维的扩展，但并没有局部极小值的处理。在 Blocks 环境中的测试效果如下：</p>

<p><img src="/assets/images/airsim/3dAPF.gif" alt="3dAPF" /></p>]]></content><author><name>Leighton</name></author><category term="AirSim" /><summary type="html"><![CDATA[参考一些已有的工作，在 AirSim 中实现了基于人工势场法（Artificial Potential Field, APF）和 LQR 控制的无人机避障任务仿真。]]></summary></entry><entry><title type="html">日本之行 关西篇</title><link href="http://localhost:4000/%E8%A1%8C%E4%B8%96%E8%B7%AF/trip-to-japan-kansai/" rel="alternate" type="text/html" title="日本之行 关西篇" /><published>2024-01-31T00:00:00+08:00</published><updated>2024-01-31T00:00:00+08:00</updated><id>http://localhost:4000/%E8%A1%8C%E4%B8%96%E8%B7%AF/trip-to-japan-kansai</id><content type="html" xml:base="http://localhost:4000/%E8%A1%8C%E4%B8%96%E8%B7%AF/trip-to-japan-kansai/"><![CDATA[<p>去年 9 月末与在沪的高中同学们聚餐时，与两位同学提出了寒假去日本旅行的想法。经过一番安排，最终包括我在内的 5 人于 1 月 14 日从大阪关西机场顺利入境，开启了我们七天八夜的日本之旅。</p>

<p>由于我们其中的 4 人都是初到日本，希望能尽可能多地领略这个国家的风光，行程安排得显得有些许仓促。在此对这趟梦幻的旅行作一个简单的记录，以供日后回味。</p>

<hr />

<h1 id="1-月-14-日入境日本大阪初印象">1 月 14 日：入境日本，大阪初印象</h1>
<p>早上在浦东机场与大家会合后，于中午 1 点左右搭乘 9C8999 次航班前往大阪关西机场。在机上填写外国人入境卡（每人一张）与行李申报卡（共用一张）后顺利通关（真的好丝滑），搭乘南海电铁前往民宿附近。</p>

<p><img src="/assets/images/JapanTrip/KIX2bnb.jpg" alt="img1" /></p>

<p>安顿后乘坐大阪地铁四つ橋線前往難波，在心斋桥吃了晚饭，随后回民宿休息。</p>

<p><img src="/assets/images/JapanTrip/dotonbori.jpg" alt="ddb" />
<img src="/assets/images/JapanTrip/bridge.jpg" alt="ddb2" /></p>

<hr />

<h1 id="1-月-15-日大阪--奈良">1 月 15 日：大阪 &amp; 奈良</h1>

<p>15 号起了个大早，和 Sam 一起到民宿不远处的罗森给大伙带了早饭（赞美民宿的微波炉），吃完早饭后前往大阪城公园。</p>

<h2 id="大阪城">大阪城</h2>
<p><img src="/assets/images/JapanTrip/osakaPolice.jpg" alt="police" /></p>
<center> 大阪警察总署（我服部平藏呢？）</center>
<p><br /></p>

<p><img src="/assets/images/JapanTrip/tenshu.jpg" alt="tenshu" />
<img src="/assets/images/JapanTrip/tenshu_close.jpg" alt="tenshu" /></p>
<center> 大阪城公园与天守阁 </center>
<p><br /></p>

<p>中午 11 点左右，从大阪城公园东南角离开，在森ノ宮駅附近吃了拌荞麦面。
<img src="/assets/images/JapanTrip/soba.jpg" alt="soba" /></p>

<p>随后乘坐 JR 大阪环状线前往鶴橋駅，换乘近鉄奈良線前往奈良。（在森ノ宮上车使以为大阪环状线是地铁，还问了工作人员为什么我们的通票不能用，有些尴尬）
<img src="/assets/images/JapanTrip/OsakaSkyline.jpg" alt="osakaskyline" /></p>
<center>近铁电车上拍摄的大阪天际线</center>
<p><br /></p>

<h2 id="奈良半日">奈良半日</h2>

<p>在奈良公园喂了鹿www
<img src="/assets/images/JapanTrip/czxAndDeers.jpg" alt="czxdeers" />
<img src="/assets/images/JapanTrip/Deers.jpg" alt="deers" /></p>

<p>前往东大寺的路上吃了点甜品
<img src="/assets/images/JapanTrip/naraDessert.jpg" alt="naradessert" /></p>

<p>东大寺，超巨大的木构建筑！
<img src="/assets/images/JapanTrip/toudaiji1.jpg" alt="toudaiji1" />
<img src="/assets/images/JapanTrip/toudaiji2.jpg" alt="toudaiji2" />
<img src="/assets/images/JapanTrip/toudaiji3.jpg" alt="toudaiji3" /></p>

<p>内部有一些巨大的佛像之类的，没问过佛祖的意见而且拍的也不怎么好看，就不放上来了。</p>

<p>游览东大寺后，向东游览了手向山（たむけやま，原友们称之为影向山）
<img src="/assets/images/JapanTrip/tamuke.jpg" alt="tamuke" /></p>

<p><img src="/assets/images/JapanTrip/mitarai.jpg" alt="mitarai" /></p>
<center>山上神社的御手洗（みたらい）</center>
<p><br /></p>

<p><img src="/assets/images/JapanTrip/nara_high.jpg" alt="narafromhigh" /></p>
<center>远眺奈良城</center>
<p><br /></p>

<p><img src="/assets/images/JapanTrip/NaraStreet.jpg" alt="narastreet" /></p>
<center>奈良街道</center>
<p><br /></p>

<h2 id="梅田夜游">梅田夜游</h2>

<p>随后乘电车回到了大阪，去梅田转了一圈，在梅田蓝天大厦上看到了大阪的夜景！
<img src="/assets/images/JapanTrip/Umeda1.jpg" alt="umeda1" /></p>

<p><img src="/assets/images/JapanTrip/Umeda2.jpg" alt="umeda2" /></p>

<p><img src="/assets/images/JapanTrip/Umeda3.jpg" alt="umeda3" /></p>

<hr />

<h1 id="1-月-16-日环球影城">1 月 16 日：环球影城</h1>

<p>头天晚上提前买好了早餐（赞美民宿的冰箱），吃完后搭乘四つ橋線到难波，换乘阪神电车到西九条，再换乘 JR 桜咲线前往环球城站（ユニバーサルシティ駅，沟槽的片假名）。</p>

<p>玩得很开心，放一些印象深刻的图片</p>

<p><img src="/assets/images/JapanTrip/universal_gate.jpg" alt="gate" />
<img src="/assets/images/JapanTrip/universal.jpg" alt="ball" /></p>

<p><img src="/assets/images/JapanTrip/SCP.jpg" alt="SCP" /></p>
<center>蜘蛛侠排队路上的 SCP 基金会，这个项目超好玩</center>
<p><br /></p>

<p><img src="/assets/images/JapanTrip/unilunch.jpg" alt="lunch" /></p>
<center>午饭：小黄人炸鸡套餐（2100日元，似乎比上迪便宜）</center>
<p><br /></p>

<p><img src="/assets/images/JapanTrip/huache.jpg" alt="huache" /></p>
<center>花车</center>
<p><br /></p>

<p><img src="/assets/images/JapanTrip/suisekai.jpg" alt="waterworld" /></p>
<center>水世界表演</center>
<p><br /></p>

<p><img src="/assets/images/JapanTrip/hogwartz.jpg" alt="hogwartz" /></p>
<center>霍格沃茨城堡</center>
<p><br /></p>

<p>随后去梅田吃了大阪烧（お好み焼き），三脚猫日语 + 英语 + 肢体语言激情点单（这不是我们玉溪的炸洋芋饼吗，下次记得标明出处
<img src="/assets/images/JapanTrip/okonomiyaki.jpg" alt="okonomiyaki" /></p>

<hr />

<h1 id="1-月-17-日京都">1 月 17 日：京都</h1>
<p>早上睡死过去了，大伙一起去 JR 大阪站吃了拉面作为早午饭，随后乘坐 JR 东海道、山阳本线前往京都。</p>

<h2 id="路途大阪站rightarrow京都民宿">路途（大阪站$\rightarrow$京都民宿）</h2>
<p><img src="/assets/images/JapanTrip/meijiFactory.jpg" alt="meiji" /></p>
<center>明治的工厂，好巨大的巧克力</center>
<p><br /></p>

<p><img src="/assets/images/JapanTrip/kyotoEki.jpg" alt="kyotostation" /></p>
<center>京都塔 &amp; JR京都站</center>
<p><br /></p>

<p><img src="/assets/images/JapanTrip/Higashi_Honen.jpg" alt="honenji" /></p>
<center>东本愿寺</center>
<p><br /></p>

<h2 id="清水寺">清水寺</h2>
<p>从民宿到清水寺并没有什么比步行明显节约时间的公共交通，于是我们骑自行车从民宿前往清水寺（赞美民宿的自行车）。</p>

<p>这几天的天气很棒，观光体验极佳！</p>

<p><img src="/assets/images/JapanTrip/farShimizu.jpg" alt="smz" /></p>
<center>远眺清水寺和好吃的抹茶冰淇淋😋</center>
<p><br /></p>

<p><img src="/assets/images/JapanTrip/smz1.jpg" alt="smz1" /></p>
<center>清水寺 &amp; 御神签 (おみくじ)</center>
<p><br /></p>

<p><img src="/assets/images/JapanTrip/blogBG.jpg" alt="blogBG" /></p>
<center>回收博客封面</center>
<p><br /></p>

<p>在拍摄上图的位置合影一张，虽然并看不出来在哪合的影（
<img src="/assets/images/JapanTrip/shashin.jpg" alt="groupPhoto" /></p>

<p>此后去三年半坐着小憩了一下，喝了一杯 “Black Tea With Milk”，付款后想起这好像就是奶茶（</p>

<h2 id="伏见稻荷大社">伏见稻荷大社</h2>
<p>骑自行车前往伏见稻荷大社，很幸运违停的自行车没有被晶哥扣走。
<img src="/assets/images/JapanTrip/bike.jpg" alt="bike" /></p>
<center>注：左一是我</center>
<p><br /></p>

<p><img src="/assets/images/JapanTrip/daohe1.jpg" alt="daisha" /></p>

<p><img src="/assets/images/JapanTrip/torii.jpg" alt="torii" />
<img src="/assets/images/JapanTrip/toriiDark.jpg" alt="torii" /></p>
<center>千张鸟居</center>
<p><br /></p>

<h2 id="晚饭嗯造和牛">晚饭：嗯造和牛</h2>
<p>晚饭决定吃和牛，遂骑行近 4 公里回到 JR 京都站附近寻找和牛店。走进了若干家早已预约满的会员制餐厅后，我们找到了一家无需预约、排队不长且评分尚可的店：<a href="https://www.bing.com/maps?osid=26635fdc-b3fe-42b7-bb4b-d15239555f0b&amp;cp=34.988291~135.748508&amp;lvl=16&amp;pi=0&amp;imgid=9c646c9b-1d23-4ac1-bc0f-38e745275251&amp;v=2&amp;sV=2&amp;form=S00027">牛カツ</a></p>

<p><img src="/assets/images/JapanTrip/wagyu.jpg" alt="gyuukatsu" /></p>

<p>和 Orange 一起豪掷 5000 日元点了一份最高级的黑毛和牛套餐！</p>

<p><img src="/assets/images/JapanTrip/wagyu_food.jpg" alt="wagyu" /></p>

<p>将每片和牛放到面前的小灶上略烤一下，搭配提供的 6 种各有特色酱料，鲜香浓郁、入口即化，不愧极品之名。牛排吃完后，将剩下的无菌蛋淋在米饭上，辅以几片盐葱，一顿兼具美味与满足感的晚饭完美结束。</p>

<p>写饿了，觅食去了。欲知后事如何，且看关东篇分解！</p>]]></content><author><name>Leighton</name></author><category term="行世路" /><summary type="html"><![CDATA[去年 9 月末与在沪的高中同学们聚餐时，与两位同学提出了寒假去日本旅行的想法。经过一番安排，最终包括我在内的 5 人于 1 月 14 日从大阪关西机场顺利入境，开启了我们七天八夜的日本之旅。]]></summary></entry><entry><title type="html">基于KCF的地面目标追踪</title><link href="http://localhost:4000/airsim/KCF-based-track/" rel="alternate" type="text/html" title="基于KCF的地面目标追踪" /><published>2024-01-02T00:00:00+08:00</published><updated>2024-01-02T00:00:00+08:00</updated><id>http://localhost:4000/airsim/KCF-based-track</id><content type="html" xml:base="http://localhost:4000/airsim/KCF-based-track/"><![CDATA[<p>这周在 AirSim 里做了一个基于 KCF 算法的地面（下方）物体追踪仿真，写一篇博客记录一下，以防后面忘记现在在干什么（</p>

<hr />

<h1 id="任务介绍">任务介绍</h1>
<p>我希望使用无人机的底部摄像头拍摄下方物体，使用 KCF 算法检测该物体的位置，使用 PID 作为控制器，通过控制无人机的水平方向速度保持目标物体处于下方摄像头拍摄图像的中央。任务流程及控制器结构如下所示。</p>

<p><img src="/assets/images/KCFtracking/mission.png" alt="mission" /></p>

<hr />

<h1 id="kcf-算法">KCF 算法</h1>
<p><del>肯德基</del>核滤波相关算法（Kernel Correlation Filter，KCF）基于核化的<strong>岭回归分类器</strong>使用循环移位得到的<strong>循环矩阵</strong>来采集正负样本，利用循环矩阵在<strong>傅里叶空间</strong>可对角化的性质，将矩阵的运算转化为元素的点乘，从而降低了运算量，使得算法满足实时性要求。同时，KCF使用<strong>多通道HOG特征</strong>代替单通道灰度特征，将特征扩展到多通道的非线性特征空间，达到了更高的鲁棒性和准确性。</p>

<h2 id="kcf-核心公式">KCF 核心公式</h2>
<ul>
  <li>
    <p>核相关矩阵的初始向量</p>

    <div class="kdmath">$$
\mathbf k^{\mathbf{xx'}}=\exp\left(-\frac{1}{\sigma^2}\left(\Vert \mathbf x\Vert^2 + \Vert \mathbf x'\Vert^2-2\mathcal F^{-1}(\sum_c\hat{\mathbf x}_c^* \odot \hat{\mathbf x_c})\right) \right)
$$</div>

    <p>其中 $\mathcal F$ 表示傅里叶变换，$\mathbf x’=\mathcal F(\mathbf x)$，$\odot$ 表示卷积</p>
  </li>
  <li>
    <p>核化后的岭回归分类器权值</p>

    <div class="kdmath">$$
\hat{\alpha}=\frac{\hat{\mathbf y}}{\hat{\mathbf k}^{\mathbf{xx}}+\lambda}
$$</div>
  </li>
  <li>
    <p>快速检测</p>

    <div class="kdmath">$$
\hat{\mathbf f}(\mathbf z)= \hat{\mathbf k}^{\mathbf{xz}} \odot \hat\alpha
$$</div>
  </li>
</ul>

<p>详细原理可参考<a href="https://blog.nowcoder.net/n/57e237d75867440f8dc329a87db4aae7?from=nowcoder_improve#KCF_102">这篇博客</a>或<a href="https://ieeexplore.ieee.org/abstract/document/6870486">论文原文</a>。</p>

<h2 id="代码实现">代码实现</h2>
<p>OpenCV 已经完成了 KCF 算法的实现，可以直接调用。我实现时参考了<a href="https://blog.csdn.net/sements/article/details/100586299">这篇博客</a>中的代码，添加了选择框。</p>

<hr />

<h1 id="pid-控制器">PID 控制器</h1>
<p>将 PID 控制器进行了简单的封装。</p>

<pre><code class="language-Python">'''
PID.py
'''

class PIDController:
    def __init__(self, kp = 1.0, ki=0.0, kd=0.0, setpoint=0):
        self.kp = kp
        self.ki = ki
        self.kd = kd
        self.setpoint = setpoint

        self.prev_error = 0
        self.integral = 0

    def update(self, current_value):
        error = self.setpoint - current_value
        self.integral += error
        derivative = error - self.prev_error

        output = self.kp * error + self.ki * self.integral + self.kd * derivative

        self.prev_error = error
        return output
</code></pre>

<hr />

<h1 id="airsim-设置">AirSim 设置</h1>
<p>更改 <code class="language-plaintext highlighter-rouge">User/Documents/AirSim/settings</code>，添加两架无人机。追踪机为 Drone1，被追踪机为 Drone2：</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"SettingsVersion"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.2</span><span class="p">,</span><span class="w">
    </span><span class="nl">"SimMode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Multirotor"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"ClockSpeed"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">

    </span><span class="nl">"Vehicles"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
		</span><span class="nl">"Drone1"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
		  </span><span class="nl">"VehicleType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SimpleFlight"</span><span class="p">,</span><span class="w">
		  </span><span class="nl">"X"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nl">"Y"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nl">"Z"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
          </span><span class="nl">"Yaw"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
		</span><span class="p">},</span><span class="w">
		</span><span class="nl">"Drone2"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
		  </span><span class="nl">"VehicleType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SimpleFlight"</span><span class="p">,</span><span class="w">
		  </span><span class="nl">"X"</span><span class="p">:</span><span class="w"> </span><span class="mi">-2</span><span class="p">,</span><span class="w"> </span><span class="nl">"Y"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nl">"Z"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
          </span><span class="nl">"Yaw"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
		</span><span class="p">}</span><span class="w">

    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>在 Python 主程序中，先控制两架无人机上升，使 Drone1 在 Drone2 上方的一定位置，随后会弹出openCV窗口（Drone1 底部摄像头），框选目标无人机，然后 Drone2 开始水平移动，Drone1 进行追踪。<a href="/assets/files/image_test.py">参考代码</a></p>

<hr />

<h1 id="追踪效果">追踪效果</h1>
<p>目前使用简单的水平匀速移动与简单的 P 控制器验证了该方案的可行性。$x$ 方向上的速度如图所示，可见 Drone1 的跟踪确实可以收敛。</p>

<p><img src="/assets/images/trace_v.png" alt="trace" /></p>]]></content><author><name>Leighton</name></author><category term="AirSim" /><summary type="html"><![CDATA[这周在 AirSim 里做了一个基于 KCF 算法的地面（下方）物体追踪仿真，写一篇博客记录一下，以防后面忘记现在在干什么（]]></summary></entry><entry><title type="html">雪国与大海：沈阳、大连游记</title><link href="http://localhost:4000/%E8%A1%8C%E4%B8%96%E8%B7%AF/trip-to-liaoning/" rel="alternate" type="text/html" title="雪国与大海：沈阳、大连游记" /><published>2023-12-26T00:00:00+08:00</published><updated>2023-12-26T00:00:00+08:00</updated><id>http://localhost:4000/%E8%A1%8C%E4%B8%96%E8%B7%AF/trip-to-liaoning</id><content type="html" xml:base="http://localhost:4000/%E8%A1%8C%E4%B8%96%E8%B7%AF/trip-to-liaoning/"><![CDATA[<p>作为一个南方孩子，一睹万里雪飘的北国风采一直是心里的一个愿望。正值防控放开后的第一个冬至遇上大四较为闲暇的时光，决定背起行囊前往东北，与在沈阳上学的好兄弟 LJ 来一趟旅行。许久未写作，这想必是一篇疏于文笔的流水账式的博客，且记录一下一路的见闻与感受。</p>

<hr />

<h1 id="沈阳篇">沈阳篇</h1>
<h2 id="12月21日前往沈阳拜见沈阳大街">12月21日：前往沈阳，拜见沈阳大街</h2>
<p>21日上午8:00，起床准备前往浦东机场。上班高峰期的上海地铁让我对未来的生活不禁升起了一丝担忧。乘坐CZ6504次航班，于上午12:00从浦东机场起飞，下午14:30到达沈阳桃仙机场。</p>

<p>在国内到达处与 LJ 汇合后，一同前往住处安顿了行李。在附近小馆子来了一顿正宗东北菜、参观完哥们的辽大崇山校区后，便打车前往狠活界的耶路撒冷<a href="https://j.map.baidu.com/63/TbLh">沈阳大街</a>（辽宁省沈阳市于洪区北陵街道黑山路12-1），奉上冰红茶与AD钙作为贡品，表达了对弟中之弟的崇高敬意（迫真</p>

<p><img src="/assets/images/Trip1/ShenyangStreet1.jpg" alt="沈阳大街" />
<img src="/assets/images/Trip1/ShenyangStreet2.jpg" alt="弟中之弟" /></p>

<h2 id="12月22日棋盘山一日">12月22日：棋盘山一日</h2>
<p>这注定是这趟旅行中最快乐的一天！<del>出于对谷爱凌的敬佩</del>在 LJ 的带领下，前往<a href="https://j.map.baidu.com/97/BvGK">棋盘山</a>进行人生第一次滑雪！</p>

<p>吃过早饭、在公交车上打了一路荒野乱斗后，我们于12点左右到达棋盘山，装备完成准备开始！
<img src="/assets/images/Trip1/ski_selfy.jpg" alt="selfie" /></p>

<p>经过滑雪带师 LJ 的双板滑雪要领教学和三趟初级道的体验后，我们前往了中级道：
<img src="/assets/images/Trip1/ski_landscape.jpg" alt="mid" />
经过一次顺利滑行后，刚上板 1.5h 从未摔跤、信心爆棚的我提议下次直接滑到魔毯（运送人们到坡顶的传送带）起点以便下次上坡。这个完美的提案随着我准备停在魔道边时减速不力、一头扎在魔道边的防护栏、滑雪杖飞出一根不见踪影戛然而止，方圆五米内充满了快活的空气。寻找消失的滑雪杖未果后，我们推理认为它可能掉在魔毯上、被运到了坡顶（确实如此）。</p>

<p>滑雪杖失而复得、又进行了一次成功下降后，我们乘坐缆车前往高级道的坡顶！
<img src="/assets/images/Trip1/ski_figure.jpg" alt="top" />
我们兵分两路，我沿背面中级道坡度但有一个大转弯的雪道下降，LJ 则顺着笔直的高级道直接下滑。于坡底成功会和后，大呼过瘾的我们决定再来一次：（记住这个yes）
<img src="/assets/images/Trip1/yeah.jpg" alt="yeah" />
于是我在坡道中间<del>精彩表演</del>失去控制来了一个180°回旋后成功梭翻在地。再写就不礼貌了 :(</p>

<p>后来，在经历了分头行动、LJ 的手机没电、我的手机卡罢工、大喇叭找人等一系列蛋疼事件后，打车回到了市区。</p>

<hr />

<h1 id="大连篇">大连篇</h1>
<h2 id="12月23日前往大连海滨的城市漫步">12月23日：前往大连，海滨的城市漫步</h2>
<p>23日，作为特种兵反例的二人起了个大早，前往沈阳站乘坐 K7322 次列车前往大连。在 Minecraft 中辛勤劳作 5 小时、榨干一整个充电宝后，我们于中午 12:40 左右到达了大连站。
<img src="/assets/images/Trip1/dalian_station.jpg" alt="大连站" /></p>

<p>前往酒店安顿后，我们在中山区及周边漫步一趟。</p>

<h3 id="中山广场">中山广场</h3>
<p><img src="/assets/images/Trip1/Zhongshan_square.jpg" alt="zhongshan" /></p>

<h3 id="友好广场">友好广场</h3>
<p>在这里的天主教堂发现了 21 世纪的转世耶稣，真是与时俱进啊（赞赏
<img src="/assets/images/Trip1/KFC.jpg" alt="KFC" />
进去聆听了吮指原味鸡的福音并探索了一下，发现二层餐厅有一个露台可以一览友好广场的风光，遂拍摄游客照若干
<img src="/assets/images/Trip1/Youai_square.jpg" alt="youhao" /></p>

<h3 id="大连中心">大连中心</h3>
<p>沿着中山路继续向西，发现了两栋风格出众（高得一批）的高楼：
<img src="/assets/images/Trip1/dalian_centre_far.jpg" alt="大连中心远景" />
经地图查证为<a href="https://j.map.baidu.com/be/ifQK">大连中心</a>。在带探险家 LJ 的提议下，我们试探性地乘坐电梯登上了大连中心ST1的顶层，得以俯瞰大连的夜景
<img src="/assets/images/Trip1/Dalian_centre.jpg" alt="daliancentre" /></p>

<h3 id="梭鱼湾">梭鱼湾</h3>
<p>久闻大连人队的主场梭鱼湾足球场之大名，我们决定在吃饭前先去梭鱼湾看看。可惜天色已晚（时间上并不），并没有辨认出灯光的梭鱼湾球场，但看到了传说中的<del>达里安造船厂</del>大连造船厂。
<img src="/assets/images/Trip1/Suoyuwan.jpg" alt="suoyuwan" />
<img src="/assets/images/Trip1/Dalian_ship.jpg" alt="ship" /></p>

<p>晚饭吃的带美食家 LJ 寻找的大连老菜馆，有一种误入会员制餐厅的感觉，也许是我没有那个享用海鲜的服气罢（悲</p>

<h2 id="12月24日老虎滩星海广场">12月24日：老虎滩、星海广场</h2>
<p>看海的一天。本来打算租个车沿着海岸来一趟愉快的自驾游，没想到两个人的微信支付分都没有达到 650 无法免押金租车，于是又是靠地铁和花小猪出行的一天（恼</p>

<p>起了个大晚，在汉巴味德嗯造一顿午餐后，我们开始了今天的行程。
<img src="/assets/images/Trip1/hanbaweide.jpg" alt="hanbaweide" /></p>

<h3 id="老虎滩">老虎滩</h3>
<p><img src="/assets/images/Trip1/laohutan.jpg" alt="laohutan" /></p>

<h3 id="星海广场">星海广场</h3>
<p>星海广场呈一个以北偏西-南偏东方向为长轴的椭圆，四周巍峨的高楼共同构筑了大连最摩登、最壮观的天际线。</p>

<p><img src="/assets/images/Trip1/XinghaiSquare.jpg" alt="xinghai" /></p>

<p>椭圆的长轴向南延申，似乎便是星海湾大桥的对称轴。大桥屹立在海上，形成的不知是对这座城市的拱卫还是对城市于大海的撕裂。</p>

<p><img src="/assets/images/Trip1/xinghaiwan_bridge.jpg" alt="xinghai_bridge" /></p>

<p><img src="/assets/images/Trip1/XinghaiBay_birds.jpg" alt="xinghai_bay" /></p>

<p><img src="/assets/images/Trip1/Xinghai_selfie.jpg" alt="xinghai_selfie" /></p>

<hr />

<h1 id="结语">结语</h1>
<p>我们在外探索的行程便到此为止了。</p>

<p>这是我第一次来到东北、第一次在厚厚的积雪上留下足迹、第一次滑雪、第一次看到蔚蓝的大海。共和国长子的人民用他们的热情与淳朴展示了这座城市的风情与生活方式，东北最南端的滨城向我们肆意展示着旖旎的风光与多元的文化构成的浪漫。楼房间大烟囱里吐出的云雾诉说着他们的故事，玻璃幕墙里略显黯淡的灯光呢喃着他们的当下。</p>

<p>时间略显紧迫，没能更加深入地探索与品味。希望以后有机会再来探访。</p>

<p><img src="/assets/images/Trip1/snowHole.jpg" alt="snow_hole" /></p>]]></content><author><name>Leighton</name></author><category term="行世路" /><summary type="html"><![CDATA[作为一个南方孩子，一睹万里雪飘的北国风采一直是心里的一个愿望。正值防控放开后的第一个冬至遇上大四较为闲暇的时光，决定背起行囊前往东北，与在沈阳上学的好兄弟 LJ 来一趟旅行。许久未写作，这想必是一篇疏于文笔的流水账式的博客，且记录一下一路的见闻与感受。]]></summary></entry><entry><title type="html">日语学习记录：基础日语（上）的语法</title><link href="http://localhost:4000/%E8%AF%AD%E8%A8%80/Japanese-Language/" rel="alternate" type="text/html" title="日语学习记录：基础日语（上）的语法" /><published>2023-12-14T00:00:00+08:00</published><updated>2023-12-14T00:00:00+08:00</updated><id>http://localhost:4000/%E8%AF%AD%E8%A8%80/Japanese-Language</id><content type="html" xml:base="http://localhost:4000/%E8%AF%AD%E8%A8%80/Japanese-Language/"><![CDATA[<p>本学期作为旁听生学习了本校的课程 FL1008-基础日语，本文用以记录本学期学到的语法和表达，以供日后温习。</p>

<p>课程所用教材为人民教育出版社出版的《标准日本语》。</p>

<hr />

<h1 id="第一单元">第一单元</h1>
<p>本单元的内容较为基础，这里总结一些自己在学习这门课程之前不是很熟悉的内容。</p>

<h2 id="事物与人的存在">事物与人的存在</h2>
<ol>
  <li>あります　与 います
表示存在的动词，あります用于不具有意志的事物，います用于具有意志的人、动物等。
    <ul>
      <li>[名(场所)] に　[名(物/人)] が　あります / います
 表示存在的句型，相当于某地有某物。
        <ul>
          <li>部屋に猫があります。      （房间里有猫）</li>
          <li>あそこに誰がいますか。    （那里有谁？）</li>
        </ul>
      </li>
      <li>[名(人/物体)] は　[名词(场所)] に　あります / います
 表示某物/某人在某个地方。
        <ul>
          <li>図書館はどこにありますか。   （图书馆在哪？）</li>
          <li>吉田さんは庭にいます。        （吉田在院子里）</li>
        </ul>
      </li>
    </ul>
  </li>
</ol>

<hr />
<h1 id="第二单元动词">第二单元：动词</h1>
<p>本单元主要是动词的ます形式，包括其过去式、动作发生的时间、地点的助词等。</p>

<h2 id="动词的ます形式">动词的ます形式</h2>
<p>肯定地叙述<strong>现在的</strong>习惯性动作、状态及<strong>未来的</strong>动作、状态时，用 “~ます”　。变化如下：</p>

<table>
    <tr>
        <td></td>
        <td>肯定</td>
        <td>否定</td>
    </tr>
    <tr>
        <td>现在</td>
        <td>~ます</td>
        <td>~ません</td>
    </tr>
    <tr>
        <td>~过去</td>
        <td>~ました</td>
        <td>~ませんでした</td>
    </tr>
</table>

<h2 id="动作发生的时间">动作发生的时间</h2>
<ol>
  <li>表示动作发生的时间，使用 [名(时间)] に [动]
<strong>包含数字</strong>的时间后需要助词に，而对于 今、昨日、今日、明日、毎日、去年、来年 等词，<strong>不可</strong>接助词に。星期几(~曜日)后可加可不加。视具体时间决定时态。
    <ul>
      <li>森さんは7時に起きます。 （森先生7点起床）</li>
    </ul>
  </li>
  <li>Aから Bまで
表示从 A 到 B 的这段时间。也可以分开使用，表示从某时起 / 到某时为止。
    <ul>
      <li>私は9時から11時まで勉強しました。　（我9点到11点在学习）</li>
    </ul>
  </li>
  <li>询问时间时使用 いつ，询问的时间很具体时，在表示时间的词后加に，如 何時に、何曜日に、何日に 等。
    <ul>
      <li>試験はいつ始まりますか。  （啥时候考试？）</li>
      <li>仕事は何時に終わりますか。 （工作<strong>几点</strong>结束？）</li>
    </ul>

    <p>まで 和 から 也可以用来提问</p>
    <ul>
      <li>あなたは　何曜日まで　休みますか。 （你休息到星期几？）</li>
    </ul>
  </li>
</ol>

<h2 id="移动动词相关">移动动词相关</h2>
<p>这里主要是和移动动词相关的一些介词以及其他。</p>
<ol>
  <li>へ：名词后接助词へ，表示移动的<strong>目的地</strong>。
    <ul>
      <li>私は来月日本へ行きます。 （我下个月去日本(此乃实话)）</li>
    </ul>
  </li>
  <li>から：使用移动动词时，此助词表示从何处出发。
    <ul>
      <li>あの方はどこから来ましたか。 （那位是从哪里来的？）</li>
    </ul>
  </li>
  <li>と：表示共同做某事的对象
    <ul>
      <li>私は昨日三苫選手とサッカーをしました。 （我昨天和三苫选手踢足球。）</li>
    </ul>
  </li>
  <li>で：可用于表示交通手段
    <ul>
      <li>僕は来月飛行機で日本へ行きます。  （我下个月坐飞机去日本）</li>
    </ul>
  </li>
  <li>A から　B まで：也可以表示从某地到某地
    <ul>
      <li>僕は来月上海から大阪まで飛行機で行きます。    （我下个月从上海坐飞机去大阪。）</li>
    </ul>
  </li>
  <li>は 作助词时，除了提出主题外，还可以用作对比。
    <ul>
      <li>小野さんは今日<strong>は</strong>休みます。</li>
      <li>
        <ul>
          <li>森さん毎朝何時に起きますか。</li>
          <li>いつも<strong>は</strong>7時ごろです。
 此外，表示对比时，は可以单独使用，也可以接在其他助词后面构成复合形式。以下是两个复合形式的例句。</li>
        </ul>
      </li>
      <li>私の部屋に<strong>は</strong>電話がありません。</li>
      <li>日本へ<strong>は</strong>行きます。韓国へ<strong>は</strong>行きません。</li>
    </ul>
  </li>
</ol>

<h2 id="动作的对象与发生的场所">动作的对象与发生的场所</h2>
<ol>
  <li>を：表示动作的对象的助词，读作お。
    <ul>
      <li>敖(ごう)さんは毎日コーヒーを飲みます。  （敖先生每天都喝咖啡。）</li>
    </ul>

    <p>买东西或点菜或索取什么东西的时候，可以用「~を　ください」，例如</p>
    <ul>
      <li>コーヒーとケーキをください。</li>
      <li>申込書をください。    （请给我一张申请书。）</li>
    </ul>
  </li>
  <li>で：表示动作发生的地点
    <ul>
      <li>私はコンビニでお弁当を買いました。    （我在便利店买了盒饭）</li>
      <li>今日はどこで勉強しますか。    （今天在哪里学习？）</li>
    </ul>
  </li>
</ol>

<h2 id="手段对象人">手段、对象（人）</h2>

<ol>
  <li>で：可以表示动作的手段、原材料等
    <ul>
      <li>日本語で手紙を書きます。  （用日语写信）</li>
      <li>新聞紙で紙飛行機を作ります。 （用报纸折纸飞机）</li>
    </ul>
  </li>
  <li>に：表示动词的对象，如把某物给某人 / 从某人处收到某物，“某人” 之后要接助词に。常用来构成一些简单的双宾语。
    <ul>
      <li>僕は小野さん<strong>に</strong>花をあげます。  （我给小野送花）</li>
      <li>僕は灰原さん<strong>に</strong>チョコレートをもらいました。    （我从灰原同学那里收到了巧克力wwww）</li>
    </ul>

    <p>会います（遇到）的对象也用に作助词。</p>
    <ul>
      <li>僕は昨日図書館で張さんに会いました。  （我昨天在图书馆遇到了张）</li>
    </ul>
  </li>
</ol>

<h2 id="其他一些表达">其他一些表达</h2>
<ul>
  <li>もう：相当于汉语的“已经”。
    <ul>
      <li>昼ご飯を食べましたか。</li>
      <li>ええ、<strong>もう</strong>食べました。</li>
    </ul>
  </li>
  <li>「たった今」、「さっき」都是表示离 现在很近的过去（刚才），其中前者比后者要离现在更近一点。搭配动词过去式。</li>
</ul>

<hr />
<h1 id="第三单元形容词">第三单元：形容词</h1>

<h2 id="形容词类型">形容词类型</h2>
<p>日语的形容词有2个类型：</p>
<ul>
  <li>一类形容词：以 い 结尾的形容词</li>
  <li>二类形容词：一类形容词以外的形容词</li>
</ul>

<h2 id="一类形容词">一类形容词</h2>
<ol>
  <li>作谓语：直接在其后加「です」即可。
 例：
    <ul>
      <li>四川料理は辛いです。</li>
      <li>このお茶は熱いです。</li>
    </ul>
  </li>
  <li>作谓语时的各种变形
    <table>
     <tr>
         <td></td>
         <td>肯定</td>
         <td>否定</td>
     </tr>
     <tr>
         <td>现在</td>
         <td>~い</td>
         <td>~くない</td>
     </tr>
     <tr>
         <td>过去</td>
         <td>~かった</td>
         <td>~くなかった / ~くありませんでした</td>
     </tr>
 </table>

    <p>例：</p>
    <ul>
      <li>旅行は楽しかったです。</li>
      <li>昨日は寒くなかったです。</li>
      <li>昨日は寒くありませんでした。</li>
    </ul>
  </li>
  <li>修饰名词：直接放在名词之前即可
 例：
    <ul>
      <li>広い国    （广阔的国家）</li>
      <li>青い海    （蓝色的大海）</li>
    </ul>
  </li>
  <li>あまり：与后面的形容词或动词的否定形式呼应，表程度不高。
    <ul>
      <li>このスープは<strong>あまり</strong>熱く<strong>ない</strong>です。  （这个汤不太热。）</li>
      <li>試験はあまり難しくない。  （考试不太难。）</li>
    </ul>
  </li>
</ol>

<h2 id="二类形容词">二类形容词</h2>
<ol>
  <li>作谓语：与一类相同，直接加「です」
    <ul>
      <li>京都の紅葉は有名です。</li>
      <li>この町は賑やかでした。　（这个城市从前很热闹）</li>
    </ul>
  </li>
  <li>作谓语的否定：[二类形] では　ありません
    <ul>
      <li>昨日は暇じゃありませんでした。</li>
    </ul>
  </li>
  <li>修饰名词：[二类形]な　[名词]
    <ul>
      <li>上海は賑やかな町です。    （上海是热闹的城市。）</li>
    </ul>
  </li>
</ol>]]></content><author><name>Leighton</name></author><category term="语言" /><summary type="html"><![CDATA[本学期作为旁听生学习了本校的课程 FL1008-基础日语，本文用以记录本学期学到的语法和表达，以供日后温习。]]></summary></entry><entry><title type="html">博客搭建相关总集</title><link href="http://localhost:4000/jekyll/site-build-summary/" rel="alternate" type="text/html" title="博客搭建相关总集" /><published>2023-12-13T00:00:00+08:00</published><updated>2023-12-13T00:00:00+08:00</updated><id>http://localhost:4000/jekyll/site-build-summary</id><content type="html" xml:base="http://localhost:4000/jekyll/site-build-summary/"><![CDATA[<p>之前添加各种功能的时候零散地写了几篇东西，似乎很没有条理的样子。以后博客建设的相关内容都会集中在这里，也许会持续更新( ᐛ )</p>

<h1 id="latex-支持">$\LaTeX$ 支持</h1>
<p>首先要解决的就是 Jekyll 博客原生不支持 LaTeX 的问题，过程如下：</p>
<ul>
  <li>首先需要禁用 Kramdown 的数学引擎，做法为在 <code class="language-plaintext highlighter-rouge">_config.yml</code> 中添加以下代码</li>
</ul>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="ss">kramdown:
    math_engine: </span><span class="n">null</span>
    </code></pre></figure>

<ul>
  <li>添加 MathJax 支持，做法为在 <code class="language-plaintext highlighter-rouge">\_includes\head.html</code> 中添加以下代码：</li>
</ul>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="o">&lt;</span><span class="n">script</span> <span class="n">src</span><span class="o">=</span><span class="s2">"https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"</span> <span class="n">type</span><span class="o">=</span><span class="s2">"text/javascript"</span><span class="o">&gt;&lt;</span><span class="sr">/script&gt;
&lt;script type="text/x</span><span class="o">-</span><span class="n">mathjax</span><span class="o">-</span><span class="n">config</span><span class="s2">"&gt;
  MathJax.Hub.Config({
    tex2jax: {
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      inlineMath: [['$','$']]
    }
  });
&lt;/script&gt;
    </span></code></pre></figure>

<p>现在我们可以愉快地书写数学公式啦！</p>
<ul>
  <li>例
    <ul>
      <li>$\LaTeX$ 代码
        <div class="language-LaTeX highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="p">$$</span><span class="nb">H</span><span class="o">(</span><span class="nb">e</span><span class="p">^{</span><span class="nb">j</span><span class="nv">\omega</span><span class="p">}</span><span class="o">)=</span><span class="nv">\int</span><span class="p">_{</span><span class="o">-</span><span class="nv">\infty</span><span class="p">}^</span><span class="nv">\infty</span><span class="nb"> x</span><span class="o">(</span><span class="nb">t</span><span class="o">)</span><span class="nb">e</span><span class="p">^{</span><span class="o">-</span><span class="nb">j</span><span class="nv">\omega</span><span class="nb"> t</span><span class="p">}{</span><span class="nv">\rm</span><span class="nb"> d</span><span class="p">}</span><span class="nb">x</span><span class="p">$$</span>
</code></pre></div>        </div>
      </li>
      <li>输出</li>
    </ul>

    <div class="kdmath">$$
H(e^{j\omega})=\int_{-\infty}^\infty h(t)e^{-j\omega t}{\rm d}t
$$</div>
  </li>
</ul>

<hr />

<h1 id="添加图片的方法">添加图片的方法</h1>
<p>根据 <a href="https://jekyllcn.com/docs/posts/">Jekyll 官方文档</a>，添加图片应使用如下代码：</p>
<pre><code class="language-Markdown">![有帮助的截图](http://localhost:4000/assets/images/RailwayMap.jpg)
</code></pre>
<p>然而经过实测，这种方法虽然可以在本地使用 <code class="language-plaintext highlighter-rouge">jekyll s</code> 命令预览时显示图片，部署到 GitHub 后却无法显示。对 GitHub Page 进行检查后发现，该图片元素的连接仍然为 <code class="language-plaintext highlighter-rouge">localhost:4000/assets/images/RailwayMap.png</code>。</p>

<p>经查证与实践，官方文档中给出的代码中的 <code class="language-plaintext highlighter-rouge">http://localhost:4000</code> 并无必要，直接使用后面的相对路径即可：</p>
<pre><code class="language-Markdown">![有帮助的截图](/assets/images/RailwayMap.png)
</code></pre>
<p>渲染效果：
<img src="/assets/images/RailwayMap.png" alt="有帮助的截图" /></p>

<hr />

<h1 id="博客分页">博客分页</h1>
<p>所有博客都显示在同一页难免显得冗长，因此我们需要分页功能。</p>

<p>根据官方文档：</p>
<ul>
  <li>
    <p>我们首先需要安装 <code class="language-plaintext highlighter-rouge">jekyll-paginate</code> 插件。在根目录下执行以下命令：</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  gem install jekyll-paginate
  bundle
</code></pre></div>    </div>
  </li>
  <li>
    <p>在根目录中的 <code class="language-plaintext highlighter-rouge">Gemfile </code>中添加：</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  gem "jekyll-paginate"
</code></pre></div>    </div>
  </li>
  <li>
    <p>在 <code class="language-plaintext highlighter-rouge">_config.yml</code> 中添加以下代码，开启分页功能并设置每页存储10篇博客</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  paginate: 10
  paginate_path: "page:num"
</code></pre></div>    </div>
  </li>
</ul>

<p>官方文档的教程到此为止。然而这样并不能够在我的模板中运行。我在<a href="https://huangjieqi.gitee.io/huangjieqi/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/2019/06/27/Study-Notes_jekyll_Pagination.html">这篇博客</a>中找到了解决方法。所需的额外步骤如下：</p>
<ul>
  <li>文章的分页显示都需要在html文档中进行，所以需要将<code class="language-plaintext highlighter-rouge">index.md</code>修改为<code class="language-plaintext highlighter-rouge">index.html</code></li>
  <li>
    <p>为<code class="language-plaintext highlighter-rouge">index.html</code>添加分页支持：</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  ---
  layout: home
  paginate: true
  ---
</code></pre></div>    </div>
  </li>
</ul>

<p>现在博客就具有翻页的功能啦：（目前文章较少，一页都能放下）
<img src="/assets/images/paginate.png" alt="翻页" /></p>

<hr />

<h1 id="博客归档">博客归档</h1>
<h2 id="基本功能">基本功能</h2>
<p>为博客添加归档可以清晰分辨出文章的类别。我参考了<a href="https://zoharandroid.github.io/2019-08-02-Jekyll%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E6%B7%BB%E5%8A%A0%E5%88%86%E7%B1%BBCategory%E5%8A%9F%E8%83%BD/">这篇博客</a>中的教程。</p>

<ul>
  <li>
    <p>修改 <code class="language-plaintext highlighter-rouge">_config.yml</code> 文件，添加以下一行代码：</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  permalink: /:categories/:title/
</code></pre></div>    </div>
  </li>
  <li>
    <p><strong>创建 categories.html 文件</strong>：在根目录下创建<code class="language-plaintext highlighter-rouge">categories.html</code>文件，并写入以下内容：</p>

    <pre><code class="language-HTML">  ---
  layout: page
  permalink: /categories/
  title: 博客分类
  ---

  &lt;!--添加搜索框--&gt;
  &lt;br/&gt;
  &lt;!-- HTML elements for search --&gt;
  &lt;input type="text" id="search-input" placeholder="搜索博客 - 输入标题/相关内容/日期/Tags.." style="width:380px;"/&gt;
  &lt;ul id="results-container"&gt;&lt;/ul&gt;

  &lt;!-- script pointing to jekyll-search.js --&gt;
  &lt;script src="\{\{ site.baseurl \}\}/js/simple-jekyll-search.min.js"&gt;&lt;/script&gt;

  &lt;script&gt;
  SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('results-container'),
      json: '/search.json',
      searchResultTemplate: '&lt;li&gt;&lt;a href="{url}" title="{desc}"&gt;{title}&lt;/a&gt;&lt;/li&gt;',
      noResultsText: '没有搜索到文章',
      limit: 20,
      fuzzy: false
  })
  &lt;/script&gt;
  &lt;br/&gt;


  &lt;div id="archives"&gt;
  {\%\for category in site.categories \%\}
  &lt;div class="archive-group"&gt;
      {\%\capture category_name \%\}\{\{ category | first \}\}{\%\endcapture \%\}
      &lt;div id="#\{\{ category_name | slugize \}\}"&gt;&lt;/div&gt;
      &lt;p&gt;&lt;/p&gt;

      &lt;h3 class="category-head"&gt;\{\{ category_name \}\} (\{\{site.categories[category_name].size()\}\})&lt;/h3&gt;
      &lt;a name="\{\{ category_name | slugize \}\}"&gt;&lt;/a&gt;
      {\%\for post in site.categories[category_name] \%\}
      &lt;article class="archive-item"&gt;
      &lt;h4&gt;&lt;a href="\{\{ site.baseurl \}\}\{\{ post.url \}\}"&gt;\{\{ post.title \}\}&lt;/a&gt;&lt;/h4&gt;
      &lt;/article&gt;
      {\%\endfor \%\}
  &lt;/div&gt;
  {\%\endfor \%\}
  &lt;/div&gt;
</code></pre>
    <p>搜索功能的代码暂时缺失，想起来的时候再加上吧 :P</p>
  </li>
  <li>
    <p>为每篇文章的 md 文件都添加一个<code class="language-plaintext highlighter-rouge">categories</code>属性，以这篇文章为例：</p>

    <pre><code class="language-Markdown">  ---
  layout: post
  title: "博客搭建相关总集"
  categories: Jekyll
  ---
</code></pre>

    <p>至此，归档页面就搭建成功啦！</p>
  </li>
  <li>
    <p>然而到这里我们却还不能在每篇文章中看出它的归档，我想让每篇文章都能直接显示出它的归档。在<code class="language-plaintext highlighter-rouge">/_layouts/post.html</code>的 <code class="language-plaintext highlighter-rouge">&lt;\header&gt;</code>标签<strong>之前</strong>添加以下代码：</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  {\%\if page.categories.size &gt; 0 \%\}
          &lt;div class="blog-tags"&gt;
          Category：
          {\%\if post \%\}
              {\%\assign categories = post.categories \%\}
          {\%\else \%\}
              {\%\assign categories = page.categories \%\}
          {\%\endif \%\}
          {\%\for category in categories \%\}
              &lt;a href="\{\{site.baseurl\}\}/categories/#\{\{category|slugize\}\}"&gt;\{\{category\}\}&lt;/a&gt;
              {\%\unless forloop.last \%\}&amp;nbsp;{\%\endunless \%\}
              {\%\endfor \%\}
          &lt;/div&gt;
      {\%\endif \%\}
</code></pre></div>    </div>
  </li>
</ul>

<p>大功告成啦：</p>

<p><img src="/assets/images/categories_result.png" alt="文章显示归档" /></p>

<h2 id="展开面板">展开面板</h2>
<p>原本的归档形式最终会随着文章的增加变回一长条，所以我将归档页面<code class="language-plaintext highlighter-rouge">categories.html</code>和<a href="https://www.runoob.com/bootstrap/bootstrap-collapse-plugin.html#:~:text=1%20data-toggle%3D%22collapse%22%20%E6%B7%BB%E5%8A%A0%E5%88%B0%E6%82%A8%E6%83%B3%E8%A6%81%E5%B1%95%E5%BC%80%E6%88%96%E6%8A%98%E5%8F%A0%E7%9A%84%E7%BB%84%E4%BB%B6%E7%9A%84%E9%93%BE%E6%8E%A5%E4%B8%8A%E3%80%82%202%20href%20%E6%88%96%20data-target,%E5%B1%9E%E6%80%A7%E6%B7%BB%E5%8A%A0%E5%88%B0%E7%88%B6%E7%BB%84%E4%BB%B6%EF%BC%8C%E5%AE%83%E7%9A%84%E5%80%BC%E6%98%AF%E5%AD%90%E7%BB%84%E4%BB%B6%E7%9A%84%20id%20%E3%80%82%203%20data-parent%20%E5%B1%9E%E6%80%A7%E6%8A%8A%E6%8A%98%E5%8F%A0%E9%9D%A2%E6%9D%BF%EF%BC%88accordion%EF%BC%89%E7%9A%84%20id%20%E6%B7%BB%E5%8A%A0%E5%88%B0%E8%A6%81%E5%B1%95%E5%BC%80%E6%88%96%E6%8A%98%E5%8F%A0%E7%9A%84%E7%BB%84%E4%BB%B6%E7%9A%84%E9%93%BE%E6%8E%A5%E4%B8%8A%E3%80%82">菜鸟教程</a>中的折叠插件结合了一下，做成了展开面板的形式。现在可以在<a href="/categories">归档</a>页面看到啦！</p>

<hr />
<h1 id="文章目录">文章目录</h1>
<p>参考<a href="https://lisz.me/tech/webmaster/jekyll-toc.html">这篇博客</a>给文章加了目录。</p>

<p>原文给出了三种方法，我采用了给 Jekyll 新增模板的方法，因为<del>我太菜了不会其他两种</del>这种方法简单高效且为 Github Pages 所原生支持。</p>
<ul>
  <li>在 <code class="language-plaintext highlighter-rouge">/_includes</code> 中新增文件 <a href="/assets/files/toc.html"><code class="language-plaintext highlighter-rouge">toc.html</code></a></li>
  <li>在 <code class="language-plaintext highlighter-rouge">_layouts</code> 中需要目录的地方加上一行代码 <code class="language-plaintext highlighter-rouge">\{\% include toc.html html=content \%\}</code>（记得删掉转义字符即可）</li>
</ul>

<p>其实我想把目录做成放在页面侧边的 sticky 样式，但是我的前端水平和我本站贫瘠的内容不允许我多折腾，于是就此作罢，放在顶部也挺好的对吧 :)</p>]]></content><author><name>Leighton</name></author><category term="Jekyll" /><summary type="html"><![CDATA[之前添加各种功能的时候零散地写了几篇东西，似乎很没有条理的样子。以后博客建设的相关内容都会集中在这里，也许会持续更新( ᐛ )]]></summary></entry><entry><title type="html">博客的图片支持测试</title><link href="http://localhost:4000/jekyll/Image-Support/" rel="alternate" type="text/html" title="博客的图片支持测试" /><published>2023-12-12T00:00:00+08:00</published><updated>2023-12-12T00:00:00+08:00</updated><id>http://localhost:4000/jekyll/Image-Support</id><content type="html" xml:base="http://localhost:4000/jekyll/Image-Support/"><![CDATA[<p>根据 Jekyll 的官方文档尝试进行图片支持。一张都市天际线城市的轨交地图：
<img src="/assets/images/RailwayMap.png" alt="有帮助的截图" /></p>]]></content><author><name>Leighton Wang</name><email>wtrwang7@sjtu.edu.cn</email></author><category term="Jekyll" /><summary type="html"><![CDATA[根据 Jekyll 的官方文档尝试进行图片支持。一张都市天际线城市的轨交地图：]]></summary></entry><entry><title type="html">AirSim：PX4软件在环仿真</title><link href="http://localhost:4000/airsim/AirSim-with-PX4/" rel="alternate" type="text/html" title="AirSim：PX4软件在环仿真" /><published>2023-12-11T00:00:00+08:00</published><updated>2023-12-11T00:00:00+08:00</updated><id>http://localhost:4000/airsim/AirSim-with-PX4</id><content type="html" xml:base="http://localhost:4000/airsim/AirSim-with-PX4/"><![CDATA[<p>今天被在 WSL2 上配置 PX4 困扰了许久，记录以下近几天解决该问题的过程。</p>

<h1 id="目的">目的</h1>
<p>想要在 AirSim 仿真中使用 PX4 作为飞控。由于手边并没有 Pixhawk、树莓派之类的硬件，考虑使用 Windows Subsystem Linux 2 (WSL2) 作为 PX4 的载体。</p>

<h1 id="wsl-安装">WSL 安装</h1>
<ol>
  <li>在 “Windows功能” 中勾选 “适用于 Linux 的 Windows 子系统” 与 “虚拟机平台” 两个选项</li>
  <li>安装 Linux 发行版
    <ol>
      <li>在 PowerShell 中输入
 <code class="language-plaintext highlighter-rouge">wsl --install</code>
 即可安装最新的 Ubuntu 发行版</li>
      <li>按照提示创建账户与密码
        <ul>
          <li>遇到错误0x800701bc，需更新 WSL 内核至最新版本：https://wslstorestorage.blob.core.windows.net/wslblob/wsl_update_x64.msi</li>
        </ul>
      </li>
      <li>将 WSL 迁移至其他盘防止 C 盘爆炸
        <ul>
          <li>关闭当前 WSL
 <code class="language-plaintext highlighter-rouge">wsl --shutdown</code></li>
          <li>迁移
 <code class="language-plaintext highlighter-rouge">wsl --export Ubuntu E:/export.tar</code></li>
          <li>将原有的Linux卸载
 <code class="language-plaintext highlighter-rouge">wsl --unregister Ubuntu</code></li>
          <li>将导出的文件放到需要保存的地方，进行导入即可
` wsl –import Ubuntu E:\export\ E:\export.tar –version 2`</li>
        </ul>
      </li>
    </ol>
  </li>
</ol>

<h1 id="airsim-安装">AirSim 安装</h1>
<p>此前已完成，此处不再赘述。可参考<a href="https://zhuanlan.zhihu.com/p/618440744">这篇博客</a></p>

<h1 id="px4-安装与配置">PX4 安装与配置</h1>
<ol>
  <li>
    <p>下载
 启动 WSL2，新建保存 PX4 的文件夹并进入
 <code class="language-plaintext highlighter-rouge">mkdir PX4</code>
 <code class="language-plaintext highlighter-rouge">cd PX4</code>
 使用 git 下载
 <code class="language-plaintext highlighter-rouge">git clone https://github.com/PX4/PX4-Autopilot.git</code>
 <code class="language-plaintext highlighter-rouge">cd PX4-Autopilot</code></p>
  </li>
  <li>在 SITL (Software-In-Loop) 模式下构建并启动 PX4 固件：
 <code class="language-plaintext highlighter-rouge">make px4_sitl_default none_iris</code>
    <ul>
      <li>记得在构建似乎会显示缺少某个 Python Module，使用 pip 安装后重新执行词条命令即可</li>
    </ul>
  </li>
  <li>
    <p>构建完成后，Linux 命令行窗口应该会显示
<code class="language-plaintext highlighter-rouge">INFO [simulator] Waiting for simulator to accpet connection on TPC port 4560</code>
此时已构建完成，进入了运行状态，可以先使用 ctrl+C 退出运行。</p>
  </li>
  <li>更改 settings.json
 目前，我们的 AirSim 仍在 simple_flight 模式。我们需要更改主机中的 <code class="language-plaintext highlighter-rouge">文档/AirSim/settings.json</code>为以下内容：
    <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w"> </span><span class="p">{</span><span class="w">
     </span><span class="nl">"SettingsVersion"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.2</span><span class="p">,</span><span class="w">
     </span><span class="nl">"SimMode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Multirotor"</span><span class="p">,</span><span class="w">
     </span><span class="nl">"ClockType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SteppableClock"</span><span class="p">,</span><span class="w">
     </span><span class="nl">"Vehicles"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
         </span><span class="nl">"PX4"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
             </span><span class="nl">"VehicleType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PX4Multirotor"</span><span class="p">,</span><span class="w">
             </span><span class="nl">"UseSerial"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
             </span><span class="nl">"LockStep"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
             </span><span class="nl">"UseTcp"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
             </span><span class="nl">"TcpPort"</span><span class="p">:</span><span class="w"> </span><span class="mi">4560</span><span class="p">,</span><span class="w">
             </span><span class="nl">"ControlIp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"172.30.146.169"</span><span class="p">,</span><span class="w">
             </span><span class="nl">"ControlPortLocal"</span><span class="p">:</span><span class="w"> </span><span class="mi">14540</span><span class="p">,</span><span class="w">
             </span><span class="nl">"ControlPortRemote"</span><span class="p">:</span><span class="w"> </span><span class="mi">14580</span><span class="p">,</span><span class="w">
             </span><span class="nl">"LocalHostIp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"172.30.144.1"</span><span class="p">,</span><span class="w">
             </span><span class="nl">"Sensors"</span><span class="p">:{</span><span class="w">
                 </span><span class="nl">"Barometer"</span><span class="p">:{</span><span class="w">
                     </span><span class="nl">"SensorType"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
                     </span><span class="nl">"Enabled"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
                     </span><span class="nl">"PressureFactorSigma"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.0001825</span><span class="w">
                 </span><span class="p">}</span><span class="w">
             </span><span class="p">},</span><span class="w">
             </span><span class="nl">"Parameters"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                 </span><span class="nl">"NAV_RCL_ACT"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
                 </span><span class="nl">"NAV_DLL_ACT"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
                 </span><span class="nl">"COM_OBL_ACT"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
                 </span><span class="nl">"LPE_LAT"</span><span class="p">:</span><span class="w"> </span><span class="mf">47.641468</span><span class="p">,</span><span class="w">
                 </span><span class="nl">"LPE_LON"</span><span class="p">:</span><span class="w"> </span><span class="mf">-122.140165</span><span class="w">
             </span><span class="p">}</span><span class="w">
         </span><span class="p">}</span><span class="w">
     </span><span class="p">}</span><span class="w">
 </span><span class="p">}</span><span class="w">
</span></code></pre></div>    </div>
    <p><strong>注意</strong>，<code class="language-plaintext highlighter-rouge">"LocalHostIp"</code> 与 <code class="language-plaintext highlighter-rouge">"ControlIp"</code> 字段分别应为主机和 WSL 的 IP 地址！</p>
    <ul>
      <li>在主机的命令行中输入 <code class="language-plaintext highlighter-rouge">ipconfig</code>，“以太网适配器 vEthernet (WSL)” 中的 “IPV4 地址” 即为主机地址</li>
      <li>在 Linux 命令行中输入 <code class="language-plaintext highlighter-rouge">ip address show</code> 即可查看 WSL 的 IP 地址</li>
    </ul>
  </li>
  <li>
    <p>设置环境变量
我们需要让 Linux 指导自己在和谁通讯，故在 Linux 命令行中输入以下命令以添加（或改变）环境变量
<code class="language-plaintext highlighter-rouge">export PX4_SIM_HOST_ADDR=172.30.144.1</code>
注意，此处的 IP 地址应为主机 IP。</p>
  </li>
  <li>更改 Linux 中的 <code class="language-plaintext highlighter-rouge">PX4-Autopilot/ROMFS/px4fmu_common/init.d-posix/rcS</code> 文件
更改这个文件之前，我一度出现了 PX4 与 AirSim 无法连接、成功连接后无法使用 Python API 等问题。经过仔细阅读官方文档中的 “PX4 SITL with WSL2”，发现了此处需要更改，原因未知（悲）。如果没有以下内容，则将它们加入到该文件中：
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> # If PX4_SIM_HOST_ADDR environment variable is empty use localhost.
 if [ -z "${PX4_SIM_HOST_ADDR}" ]; then
     echo "PX4 SIM HOST: localhost"
     simulator start -c $simulator_tcp_port
 else
     echo "PX4 SIM HOST: $PX4_SIM_HOST_ADDR"
     simulator start -t $PX4_SIM_HOST_ADDR $simulator_tcp_port
 fi
</code></pre></div>    </div>
  </li>
  <li>完成后，启动 sln 文件的调试以进入 UE4 编辑器，并在 Linux 中启动 PX4：
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> make px4_sitl_defalut none_iris
</code></pre></div>    </div>
    <p>我们就完成了 PX4 作为飞控的 AirSim 仿真啦！</p>
  </li>
</ol>

<h1 id="使用">使用</h1>
<ul>
  <li>可以在 PX4 端输入命令以控制无人机，如 <code class="language-plaintext highlighter-rouge">commander takeoff</code> 可控制无人机起飞，<code class="language-plaintext highlighter-rouge">commander land</code> 可控制无人机降落。</li>
  <li>调用 Python API 的操作与使用 simple_flight 模式下相同，直接运行 Python 脚本即可！</li>
</ul>]]></content><author><name>Leighton Wang</name><email>wtrwang7@sjtu.edu.cn</email></author><category term="AirSim" /><summary type="html"><![CDATA[今天被在 WSL2 上配置 PX4 困扰了许久，记录以下近几天解决该问题的过程。]]></summary></entry></feed>